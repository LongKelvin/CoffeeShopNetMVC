<link href="~/Assets/Client/custom-css/custom-style.css" rel="stylesheet" />
@model CoffeeShop.Web.Infrastucture.Core.PaginationSet<CoffeeShop.Web.Models.ProductViewModel>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section class="product_section layout_padding custom-container">
    <div class="heading_container heading_center">
        <h2>
            Our <span>Menu</span>
        </h2>
    </div>
    <div class="row flex-column-reverse flex-lg-row">
        <div class="col-lg-3 col-md-4 col-lg-pull-9 col-md-pull-8 ">
            <div class="margin-top">
                <div class="card card-info recent-cart">
                    <h4 class="card-header card-white"><strong>Cart</strong></h4>
                    <ul class="cart-order card-body">
                        <li class="order-item row">
                            <div class="item-image col-4 flexiable-img">
                                <img src="~/Assets/Client/images/menu-item-1.jpg" />
                            </div>
                            <div class="col-6">
                                <p>
                                    <b class="product-name ">ESPRESSO AMERICANO</b>
                                    <br />
                                    <strong>2</strong> x <span class="product-price">$12</span>
                                </p>
                            </div>
                            <div class="col-2 w-100 btn-close">
                                <button type="button" class="close"> <span class="text-danger" aria-hidden="true">&times;</span></button>
                            </div>
                        </li>
                        <li class="order-item row ">
                            <div class="item-image col-4 flexiable-img">
                                <img src="~/Assets/Client/images/menu-item-2.jpg" />
                            </div>
                            <div class="col-6">
                                <p>
                                    <b class="product-name ">DOUBLE ESPRESSO</b>
                                    <br />
                                    <strong>2</strong> x <span class="product-price">$12</span>
                                </p>
                            </div>
                            <div class="col-2 w-100">
                                <button type="button" class="close "> <span class="text-danger" aria-hidden="true">&times;</span></button>
                            </div>
                        </li>
                        <li class="order-item row">
                            <div class="item-image col-4 flexiable-img">
                                <img src="~/Assets/Client/images/menu-item-7.jpg" />
                            </div>
                            <div class="col-6">
                                <p>
                                    <b class="product-name ">ICED LATTE</b>
                                    <br />
                                    <strong>2</strong> x <span class="product-price">$12</span>
                                </p>
                            </div>
                            <div class="col-2 w-100">
                                <button type="button" class="close "> <span class="text-danger" aria-hidden="true">&times;</span></button>
                            </div>
                        </li>
                        <li class="order-item row">
                            <div class="item-image col-4 flexiable-img">
                                <img src="~/Assets/Client/images/menu-item-5.jpg" />
                            </div>
                            <div class="col-6">
                                <p>
                                    <b class="product-name ">LATTE MACCHIATO</b>
                                    <br />
                                    <strong>2</strong> x <span class="product-price">$12</span>
                                </p>
                            </div>
                            <div class="col-2 w-100">
                                <button type="button" class="close "> <span class="text-danger" aria-hidden="true">&times;</span></button>
                            </div>
                        </li>
                    </ul>
                    <div class="card card-footer text-center">
                        <div class="sub_total ">
                            <h5><b>Sub Total: $156.94</b></h5>
                        </div>
                        <div class="btn-box">
                            <a href="" class="btn-secondary  flexible-btn">
                                Xem giỏ hàng
                            </a>
                        </div>
                        <div class="btn-box">
                            <a href="@Url.Action("Index","Cart")" class="btn-checkout  flexible-btn">
                                Đặt hàng
                            </a>
                        </div>
                    </div>
                </div>

                @*Product categories section*@
                @{ Html.RenderAction("Index", "ProductCategory");}
            </div>
        </div>
        <div class="col-lg-9 col-lg-push-3 col-md-8 col-md-push-4 ">

            @if (Model.Items.Count == 0)
            {
                <div class="row w-100  text-center ">
                    <div class=" w-100 align-items-center text-black-50"> <b>No product to display</b></div>
                </div>

                <div class="btn-box">
                    <a href="@Url.Action("Index","Product")">
                        View All products
                    </a>
                </div>
            }
            else
            {
                <div class="row col-12 text-right m-0">
                    <ul class="horizontal-list">
                        <li>Sort : </li>
                        <li><a class="active" href="#">popular</a></li> |
                        <li><a href="#">new </a></li> |
                        <li><a href="#">discount</a></li> |
                        <li><a href="#">price: Low to High </a></li>|
                        <li><a href="#">price: High to Low </a></li>
                    </ul>
                </div>

                <div class="row">
                    @foreach (var item in Model.Items)
                    {
                        var url = "/" + item.Alias + "-id-" + item.ID;

                        <div class="col-sm-6 col-md-4 col-lg-4">
                            <div class="box">
                                <div class="option_container">
                                    <div class="options">
                                        <a href="@url" class="option3">
                                            View Detail
                                        </a>
                                        <a href="" class="option1">
                                            Add To Cart
                                        </a>
                                        <a href="" class="option2">
                                            Order Now
                                        </a>
                                    </div>
                                </div>
                                <div class="img-box">

                                    <img src="@item.Images" />
                                </div>
                                <div class="detail-box">
                                    <h5>
                                        @item.Name
                                    </h5>
                                    <h6>
                                        @item.Price.ToString("N2")
                                    </h6>
                                </div>
                            </div>
                        </div>
                    }
                </div>

                <div class="btn-box">
                    <a href="">
                        View All products
                    </a>
                </div>
            }
        </div>
    </div>

    <div class="clearfix">
        @if (Model.TotalPages > 1)
        {
            // Create numeric links
            var startPageIndex = Math.Max(1, Model.Page - Model.Page / 2);
            var endPageIndex = Math.Min(Model.TotalPages, Model.Page + Model.Page / 2);

            <nav aria-label="Page navigation example">

                <ul class="pagination justify-content-end">
                    @if (Model.Page > 1)
                    {
                        <li class="page-item">
                            <a class="page-link" href="?page=1" aria-label="First">
                                First
                            </a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?page=@(Model.Page-1)" aria-label="Previous">
                                Previous
                            </a>
                        </li>
                    }
                    else
                    {
                        <li class="page-item disabled">

                            <a class="page-link" href="?page=1" aria-label="First">
                                First
                            </a>
                        </li>
                        <li class="page-item disabled">
                            <a class="page-link" href="?page=@(Model.Page-1)" aria-label="Previous">
                                Previous
                            </a>
                        </li>
                    }

                    @for (int i = startPageIndex; i <= endPageIndex; i++)
                    {
                        if (Model.Page == i)
                        {
                            <li class="page-item active"><a class="page-link" ref="?page=@i" title="Trang @i">@i</a></li>
                        }
                        else
                        {
                            <li class="page-item"><a class="page-link" href="?page=@i" title="Trang @i">@i</a></li>
                        }
                    }
                    @if (Model.Page < Model.TotalPages)
                    {
                        <li class="page-item">
                            <a class="page-link" href="?page=@(Model.Page+1)" aria-label="Next">
                                Next
                            </a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?page=@Model.TotalPages" aria-label="Last">
                                Last
                            </a>
                        </li>
                    }
                    else
                    {
                        <li class="page-item disabled">
                            <a class="page-link" href="?page=@(Model.Page)" aria-label="Next">
                                Next
                            </a>
                        </li>
                        <li class="page-item disabled">
                            <a class="page-link" href="?page=@Model.TotalPages" aria-label="Last">
                                Last
                            </a>
                        </li>
                    }
                </ul>
            </nav>
        }
    </div>
</section>
<script src="~/Assets/Client/js/jquery-3.4.1.min.js"></script>
<script>
    $('.close').click(function () {
        $(this).closest('li').remove();
        checkCartList();
    })

    function checkCartList() {
        if ($('.cart-order li').length === 0) {
            $('.cart-order li').html('Cart is empty')
        }
        console.log($('.cart-order li').length)
    }
</script>